#summary Current instructions on how I created heightfields using World Machine and imported them into LDraw.


= FOR NON-STEPPED TERRAIN =

# Open "worldmachine_project.tmd" in World Machine or create a new project.
# In World Machine select "World Commands" > "Project World Parameters...".
# In the "Render Extents and Normal Build Resolution" tab make sure that the "Resolution" setting is set to 128x128 and that the "+1" box is checked. Checking the "+1" box will change the resolution to 129x129. This is OK.
# Also make sure that the "Lower Left Coordinate" setting is set to 0.000000 and 0.000000 and that the "Upper Right Coordinate" setting is set to 1.000000 and 1.000000.
# In the "General Setup" tab make sure that the "Maximum Elevation" setting is set to 1.000000 and that the "Base Elevation" setting is set to 0.000000.
# Also make sure that the "Dimensionality" setting is set to "World Machine Units".
# Continue to tweak the other heightfield parameters if you want. Then export from World Machine as "worldmachine_output.obj".
# Open "worldmachine_output.obj" in MeshLab.
# In MeshLab select "Filters" > "Normals, Curvatures and Orientation" > "Transform: Move, Translate, Center". Check the "translate center of bbox to the origin" box and click "Apply" then "Close".
# In MeshLab select "Filters" > "Normals, Curvatures and Orientation" > "Transform: Rotate". Set the Rotation angle to 90 and click "Apply" then "Close".
# In MeshLab select "Filters" > "Normals, Curvatures and Orientation" > "Transform: Scale". Uncheck the "Uniform Scaling" box. Then set the X Axis value to 81920, the Y Axis value to 15360, and the Z Axis value to 81920. Click "Apply" then "Close". This dialog is a bit buggy so you will have trouble entering the scaling values.
# In MeshLab select "File" > "Export Mesh As...". Export the file as "meshlab_output_nosteps.stl".
# Using the command prompt or a batch file convert the STL file to LDR using "stl2dat.exe". An example of the command line looks like this:
	stl2dat meshlab_output_nosteps.stl -ldr -raw
# Open the model in MLCAD. The model may be upside-down, so rotate 180 degrees around the x-axis if needed.
# You're basically done. You can do any post-processing you want in LETGUI, such as adding conditional lines using Edger2 or converting triangles to rectangles using rectifier.

= FOR STEPPED TERRAIN =

# Open "worldmachine_project.tmd" in World Machine or create a new project.
# In World Machine select "World Commands" > "Project World Parameters...".
# In the "Render Extents and Normal Build Resolution" tab make sure that the "Resolution" setting is set to 128x128 and that the "+1" box is checked. Checking the "+1" box will change the resolution to 129x129. This is OK.
# Also make sure that the "Lower Left Coordinate" setting is set to 0.000000 and 0.000000 and that the "Upper Right Coordinate" setting is set to 1.000000 and 1.000000.
# In the "General Setup" tab make sure that the "Maximum Elevation" setting is set to 1.000000 and that the "Base Elevation" setting is set to 0.000000.
# Also make sure that the "Dimensionality" setting is set to "World Machine Units".
# Continue to tweak the other heightfield parameters if you want. Then export from World Machine as "worldmachine_output.obj".
# Open "worldmachine_output.obj" in MeshLab.
# In MeshLab select "Filters" > "Normals, Curvatures and Orientation" > "Transform: Move, Translate, Center". Check the "translate center of bbox to the origin" box and click "Apply" then "Close".
# In MeshLab select "Filters" > "Normals, Curvatures and Orientation" > "Transform: Rotate". Set the Rotation angle to 90 and click "Apply" then "Close".
# In MeshLab select "Filters" > "Normals, Curvatures and Orientation" > "Transform: Scale". Uncheck the "Uniform Scaling" box. Then set the X Axis value to 81920, the Y Axis value to 640, and the Z Axis value to 81920. Click "Apply" then "Close". This dialog is a bit buggy so you will have trouble entering the scaling values.
# In MeshLab select "File" > "Export Mesh As...". Export the file as "meshlab_output_stepped.stl".
# Using the command prompt or a batch file convert the STL file to LDR using "stl2dat.exe". An example of the command line looks like this:
	stl2dat meshlab_output_stepped.stl -ldr -raw
# Open the LDR file in LDDP.
# Change decimal accuracy to 0 by going to "Tools" > "Options" > "Configuration Values" tab > "Editor Behavior" subtab and setting "Position Decimal Accuracy" to zero. Then select all (ctrl A) and round everything (ctrl D).
# Save the LDR file in LDDP.
# Convert the LDR file to Wavefront OBJ using 3DWin. Export as "3DWin_output.obj".......3DWin rotates the model again!!!! Stop using 3DWin!!!!......
# Open "3DWin_output.obj" in MeshLab.
# In MeshLab rotate the model again by 90 degrees if needed because 3DWin changes the rotation when exporting for some reason. Then scale the height by 24 along the y-axis.
# In MeshLab select "File" > "Export Mesh As...". Export the file as "meshlab_output_stepped.stl".
# Using the command prompt or a batch file convert the STL file to LDR using "stl2dat.exe". An example of the command line looks like this:
	stl2dat meshlab_output_stepped.stl -ldr -raw
# Open the LDR model in MLCAD. The model may be upside-down, so rotate 180 degrees around the x-axis if needed.
# All triangle vertices should be integer multiples of 8 at this stage. If you see any decimal values, then you may need one more pass rounding the numbers in LDDP.
# You're basically done. You can do any post-processing you want in LETGUI, such as adding conditional lines using Edger2 or converting triangles to rectangles using rectifier.

= TO DO =

# I still need to figure out how to split the heightfield mesh into 8x8 sections (or larger).
# Eliminate 3DWin from the process somehow.
